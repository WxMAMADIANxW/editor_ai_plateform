FROM python:3.8-slim-buster

COPY requirements.txt requirements.txt

RUN pip3 install --upgrade pip
RUN pip3 install -r requirements.txt

COPY main.py main.py

ARG SQS_QUEUE_NAME
ARG AWS_REGION=us-east-1

ARG REDIS_HOST
ARG REDIS_PORT=6379
ARG REDIS_PASSWORD
ARG REDIS_USERNAME

ENV SQS_QUEUE_NAME=${SQS_QUEUE_NAME}
ENV AWS_REGION=${AWS_REGION}

ENV REDIS_HOST=${REDIS_HOST}
ENV REDIS_PORT=${REDIS_PORT}
ENV REDIS_USERNAME=${REDIS_USERNAME}
ENV REDIS_PASSWORD=${REDIS_PASSWORD}

CMD ["python3", "main.py"]